{% extends "base.html" %}

{% block title %}è¯æ±‡ç®¡ç† - èƒŒå•è¯åº”ç”¨{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- å¯¼èˆªæ  -->
    <div class="row mb-4">
        <div class="col-12">
            <nav class="navbar navbar-expand-lg navbar-light bg-light rounded">
                <div class="container-fluid">
                    <span class="navbar-brand mb-0 h1">ğŸ“š è¯æ±‡ç®¡ç†</span>
                    <div class="navbar-nav ms-auto">
                        <a class="nav-link" href="/">ğŸ  è¿”å›é¦–é¡µ</a>
                        <a class="nav-link" href="/practice">ğŸ“ å¼€å§‹ç»ƒä¹ </a>
                    </div>
                </div>
            </nav>
        </div>
    </div>
    
    <!-- æœç´¢å’Œæ“ä½œæ  -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="input-group">
                <input type="text" class="form-control" id="search-input" placeholder="æœç´¢å•è¯...">
                <button class="btn btn-outline-secondary" type="button" id="search-btn">
                    <i class="fas fa-search"></i> æœç´¢
                </button>
            </div>
        </div>
        <div class="col-md-6 text-end">
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addWordModal">
                <i class="fas fa-plus"></i> æ·»åŠ å•è¯
            </button>
            <button class="btn btn-info ms-2" data-bs-toggle="modal" data-bs-target="#batchAddModal">
                <i class="fas fa-upload"></i> æ‰¹é‡æ·»åŠ 
            </button>
        </div>
    </div>
    
    <!-- å•è¯åˆ—è¡¨ -->
    <div class="row" id="words-container">
        <!-- åŠ¨æ€åŠ è½½å•è¯å¡ç‰‡ -->
    </div>
    
    <!-- åˆ†é¡µ -->
    <div class="row mt-4">
        <div class="col-12">
            <nav>
                <ul class="pagination justify-content-center" id="pagination">
                    <!-- åŠ¨æ€ç”Ÿæˆåˆ†é¡µ -->
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- æ·»åŠ å•è¯æ¨¡æ€æ¡† -->
<div class="modal fade" id="addWordModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">æ·»åŠ æ–°å•è¯</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="add-word-form">
                    <div class="mb-3">
                        <label for="add-english" class="form-label">è‹±æ–‡å•è¯ *</label>
                        <input type="text" class="form-control" id="add-english" required>
                    </div>
                    <div class="mb-3">
                        <label for="add-chinese" class="form-label">ä¸­æ–‡é‡Šä¹‰ *</label>
                        <input type="text" class="form-control" id="add-chinese" required>
                    </div>
                    <div class="mb-3">
                        <label for="add-phonetic" class="form-label">éŸ³æ ‡</label>
                        <input type="text" class="form-control" id="add-phonetic" placeholder="ä¾‹å¦‚: /ËˆhÃ¦pÉª/">
                    </div>
                    <div class="mb-3">
                        <label for="add-part-of-speech" class="form-label">è¯æ€§</label>
                        <select class="form-select" id="add-part-of-speech">
                            <option value="">é€‰æ‹©è¯æ€§</option>
                            <option value="n.">åè¯ (n.)</option>
                            <option value="v.">åŠ¨è¯ (v.)</option>
                            <option value="adj.">å½¢å®¹è¯ (adj.)</option>
                            <option value="adv.">å‰¯è¯ (adv.)</option>
                            <option value="prep.">ä»‹è¯ (prep.)</option>
                            <option value="conj.">è¿è¯ (conj.)</option>
                            <option value="pron.">ä»£è¯ (pron.)</option>
                            <option value="int.">æ„Ÿå¹è¯ (int.)</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="add-example" class="form-label">ä¾‹å¥</label>
                        <textarea class="form-control" id="add-example" rows="2" placeholder="è‹±æ–‡ä¾‹å¥"></textarea>
                    </div>
                    <div class="mb-3">
                        <button type="button" class="btn btn-info" id="generate-ai-details">
                            <i class="fas fa-magic"></i> AIç”Ÿæˆè¯¦ç»†ä¿¡æ¯
                        </button>
                        <small class="text-muted d-block mt-1">åŸºäºè‹±æ–‡å•è¯è‡ªåŠ¨ç”ŸæˆéŸ³æ ‡ã€è¯æ€§å’Œä¾‹å¥</small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" id="save-word-btn">ä¿å­˜</button>
            </div>
        </div>
    </div>
</div>

<!-- ç¼–è¾‘å•è¯æ¨¡æ€æ¡† -->
<div class="modal fade" id="editWordModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ç¼–è¾‘å•è¯</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="edit-word-form">
                    <input type="hidden" id="edit-word-id">
                    <div class="mb-3">
                        <label for="edit-english" class="form-label">è‹±æ–‡å•è¯ *</label>
                        <input type="text" class="form-control" id="edit-english" required>
                    </div>
                    <div class="mb-3">
                        <label for="edit-chinese" class="form-label">ä¸­æ–‡é‡Šä¹‰ *</label>
                        <input type="text" class="form-control" id="edit-chinese" required>
                    </div>
                    <div class="mb-3">
                        <label for="edit-phonetic" class="form-label">éŸ³æ ‡</label>
                        <input type="text" class="form-control" id="edit-phonetic">
                    </div>
                    <div class="mb-3">
                        <label for="edit-part-of-speech" class="form-label">è¯æ€§</label>
                        <select class="form-select" id="edit-part-of-speech">
                            <option value="">é€‰æ‹©è¯æ€§</option>
                            <option value="n.">åè¯ (n.)</option>
                            <option value="v.">åŠ¨è¯ (v.)</option>
                            <option value="adj.">å½¢å®¹è¯ (adj.)</option>
                            <option value="adv.">å‰¯è¯ (adv.)</option>
                            <option value="prep.">ä»‹è¯ (prep.)</option>
                            <option value="conj.">è¿è¯ (conj.)</option>
                            <option value="pron.">ä»£è¯ (pron.)</option>
                            <option value="int.">æ„Ÿå¹è¯ (int.)</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="edit-example" class="form-label">ä¾‹å¥</label>
                        <textarea class="form-control" id="edit-example" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" id="update-word-btn">æ›´æ–°</button>
            </div>
        </div>
    </div>
</div>

<!-- æ‰¹é‡æ·»åŠ æ¨¡æ€æ¡† -->
<div class="modal fade" id="batchAddModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">æ‰¹é‡æ·»åŠ å•è¯</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="batch-words" class="form-label">å•è¯åˆ—è¡¨</label>
                    <textarea class="form-control" id="batch-words" rows="10" 
                              placeholder="è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å…¥ï¼Œæ¯è¡Œä¸€ä¸ªå•è¯ï¼š&#10;apple,è‹¹æœ&#10;banana,é¦™è•‰&#10;cat,çŒ«&#10;&#10;æˆ–è€…ï¼š&#10;apple|è‹¹æœ|/ËˆÃ¦pl/|n.|An apple is a fruit.&#10;banana|é¦™è•‰|/bÉ™ËˆnÃ¦nÉ™/|n.|I like to eat bananas."></textarea>
                </div>
                <div class="alert alert-info">
                    <strong>æ ¼å¼è¯´æ˜ï¼š</strong><br>
                    â€¢ ç®€å•æ ¼å¼ï¼š<code>è‹±æ–‡,ä¸­æ–‡</code><br>
                    â€¢ å®Œæ•´æ ¼å¼ï¼š<code>è‹±æ–‡|ä¸­æ–‡|éŸ³æ ‡|è¯æ€§|ä¾‹å¥</code><br>
                    â€¢ æ¯è¡Œä¸€ä¸ªå•è¯
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" id="batch-add-btn">æ‰¹é‡æ·»åŠ </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
let currentPage = 1;
let currentSearch = '';
const wordsPerPage = 12;

// åŠ è½½å•è¯åˆ—è¡¨
async function loadWords(page = 1, search = '') {
    try {
        const response = await fetch(`/api/words?page=${page}&per_page=${wordsPerPage}&search=${encodeURIComponent(search)}`);
        const data = await response.json();
        
        displayWords(data.words);
        displayPagination(data.pagination);
        
        currentPage = page;
        currentSearch = search;
    } catch (error) {
        console.error('åŠ è½½å•è¯å¤±è´¥:', error);
        document.getElementById('words-container').innerHTML = `
            <div class="col-12">
                <div class="alert alert-danger text-center">
                    <h4>åŠ è½½å¤±è´¥</h4>
                    <p>è¯·åˆ·æ–°é¡µé¢é‡è¯•</p>
                </div>
            </div>
        `;
    }
}

// æ˜¾ç¤ºå•è¯å¡ç‰‡
function displayWords(words) {
    const container = document.getElementById('words-container');
    
    if (words.length === 0) {
        container.innerHTML = `
            <div class="col-12">
                <div class="alert alert-info text-center">
                    <h4>æš‚æ— å•è¯</h4>
                    <p>ç‚¹å‡»"æ·»åŠ å•è¯"å¼€å§‹å»ºç«‹ä½ çš„è¯æ±‡åº“</p>
                </div>
            </div>
        `;
        return;
    }
    
    const wordsHtml = words.map(word => `
        <div class="col-md-4 col-lg-3 mb-3">
            <div class="card h-100 word-card">
                <div class="card-body">
                    <h5 class="card-title">${word.english}</h5>
                    <p class="card-text">
                        <strong>${word.chinese}</strong><br>
                        ${word.phonetic ? `<small class="text-muted">${word.phonetic}</small><br>` : ''}
                        ${word.part_of_speech ? `<span class="badge bg-secondary">${word.part_of_speech}</span>` : ''}
                    </p>
                    ${word.example ? `<p class="card-text"><small class="text-muted">${word.example}</small></p>` : ''}
                </div>
                <div class="card-footer bg-transparent">
                    <div class="btn-group w-100" role="group">
                        <button class="btn btn-outline-primary btn-sm" onclick="editWord(${word.id})">
                            <i class="fas fa-edit"></i> ç¼–è¾‘
                        </button>
                        <button class="btn btn-outline-danger btn-sm" onclick="deleteWord(${word.id}, '${word.english}')">
                            <i class="fas fa-trash"></i> åˆ é™¤
                        </button>
                        <button class="btn btn-outline-info btn-sm" onclick="generateAIDetails(${word.id})">
                            <i class="fas fa-magic"></i> AI
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `).join('');
    
    container.innerHTML = wordsHtml;
}

// æ˜¾ç¤ºåˆ†é¡µ
function displayPagination(pagination) {
    const paginationContainer = document.getElementById('pagination');
    
    if (pagination.total_pages <= 1) {
        paginationContainer.innerHTML = '';
        return;
    }
    
    let paginationHtml = '';
    
    // ä¸Šä¸€é¡µ
    if (pagination.has_prev) {
        paginationHtml += `
            <li class="page-item">
                <a class="page-link" href="#" onclick="loadWords(${pagination.current_page - 1}, '${currentSearch}')">
                    ä¸Šä¸€é¡µ
                </a>
            </li>
        `;
    }
    
    // é¡µç 
    const startPage = Math.max(1, pagination.current_page - 2);
    const endPage = Math.min(pagination.total_pages, pagination.current_page + 2);
    
    for (let i = startPage; i <= endPage; i++) {
        paginationHtml += `
            <li class="page-item ${i === pagination.current_page ? 'active' : ''}">
                <a class="page-link" href="#" onclick="loadWords(${i}, '${currentSearch}')">
                    ${i}
                </a>
            </li>
        `;
    }
    
    // ä¸‹ä¸€é¡µ
    if (pagination.has_next) {
        paginationHtml += `
            <li class="page-item">
                <a class="page-link" href="#" onclick="loadWords(${pagination.current_page + 1}, '${currentSearch}')">
                    ä¸‹ä¸€é¡µ
                </a>
            </li>
        `;
    }
    
    paginationContainer.innerHTML = paginationHtml;
}

// æœç´¢å•è¯
function searchWords() {
    const searchTerm = document.getElementById('search-input').value.trim();
    loadWords(1, searchTerm);
}

// æ·»åŠ å•è¯
async function addWord() {
    const english = document.getElementById('add-english').value.trim();
    const chinese = document.getElementById('add-chinese').value.trim();
    const phonetic = document.getElementById('add-phonetic').value.trim();
    const partOfSpeech = document.getElementById('add-part-of-speech').value;
    const example = document.getElementById('add-example').value.trim();
    
    if (!english || !chinese) {
        alert('è¯·å¡«å†™è‹±æ–‡å•è¯å’Œä¸­æ–‡é‡Šä¹‰');
        return;
    }
    
    try {
        const response = await fetch('/api/words', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                english: english,
                chinese: chinese,
                phonetic: phonetic,
                part_of_speech: partOfSpeech,
                example: example
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            // å…³é—­æ¨¡æ€æ¡†
            const modal = bootstrap.Modal.getInstance(document.getElementById('addWordModal'));
            modal.hide();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('add-word-form').reset();
            
            // é‡æ–°åŠ è½½å•è¯åˆ—è¡¨
            loadWords(currentPage, currentSearch);
            
            alert('å•è¯æ·»åŠ æˆåŠŸï¼');
        } else {
            alert(result.message || 'æ·»åŠ å¤±è´¥');
        }
    } catch (error) {
        console.error('æ·»åŠ å•è¯å¤±è´¥:', error);
        alert('æ·»åŠ å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// ç¼–è¾‘å•è¯
async function editWord(wordId) {
    try {
        // è·å–å•è¯è¯¦æƒ…
        const response = await fetch(`/api/words?search=id:${wordId}`);
        const data = await response.json();
        
        if (data.words.length > 0) {
            const word = data.words[0];
            
            // å¡«å……ç¼–è¾‘è¡¨å•
            document.getElementById('edit-word-id').value = word.id;
            document.getElementById('edit-english').value = word.english;
            document.getElementById('edit-chinese').value = word.chinese;
            document.getElementById('edit-phonetic').value = word.phonetic || '';
            document.getElementById('edit-part-of-speech').value = word.part_of_speech || '';
            document.getElementById('edit-example').value = word.example || '';
            
            // æ˜¾ç¤ºç¼–è¾‘æ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('editWordModal'));
            modal.show();
        }
    } catch (error) {
        console.error('è·å–å•è¯è¯¦æƒ…å¤±è´¥:', error);
        alert('è·å–å•è¯è¯¦æƒ…å¤±è´¥');
    }
}

// æ›´æ–°å•è¯
async function updateWord() {
    const wordId = document.getElementById('edit-word-id').value;
    const english = document.getElementById('edit-english').value.trim();
    const chinese = document.getElementById('edit-chinese').value.trim();
    const phonetic = document.getElementById('edit-phonetic').value.trim();
    const partOfSpeech = document.getElementById('edit-part-of-speech').value;
    const example = document.getElementById('edit-example').value.trim();
    
    if (!english || !chinese) {
        alert('è¯·å¡«å†™è‹±æ–‡å•è¯å’Œä¸­æ–‡é‡Šä¹‰');
        return;
    }
    
    try {
        const response = await fetch(`/api/words/${wordId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                english: english,
                chinese: chinese,
                phonetic: phonetic,
                part_of_speech: partOfSpeech,
                example: example
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            // å…³é—­æ¨¡æ€æ¡†
            const modal = bootstrap.Modal.getInstance(document.getElementById('editWordModal'));
            modal.hide();
            
            // é‡æ–°åŠ è½½å•è¯åˆ—è¡¨
            loadWords(currentPage, currentSearch);
            
            alert('å•è¯æ›´æ–°æˆåŠŸï¼');
        } else {
            alert(result.message || 'æ›´æ–°å¤±è´¥');
        }
    } catch (error) {
        console.error('æ›´æ–°å•è¯å¤±è´¥:', error);
        alert('æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// åˆ é™¤å•è¯
async function deleteWord(wordId, english) {
    if (!confirm(`ç¡®å®šè¦åˆ é™¤å•è¯ "${english}" å—ï¼Ÿ`)) {
        return;
    }
    
    try {
        const response = await fetch(`/api/words/${wordId}`, {
            method: 'DELETE'
        });
        
        const result = await response.json();
        
        if (result.success) {
            // é‡æ–°åŠ è½½å•è¯åˆ—è¡¨
            loadWords(currentPage, currentSearch);
            alert('å•è¯åˆ é™¤æˆåŠŸï¼');
        } else {
            alert(result.message || 'åˆ é™¤å¤±è´¥');
        }
    } catch (error) {
        console.error('åˆ é™¤å•è¯å¤±è´¥:', error);
        alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// æ‰¹é‡æ·»åŠ å•è¯
async function batchAddWords() {
    const wordsText = document.getElementById('batch-words').value.trim();
    
    if (!wordsText) {
        alert('è¯·è¾“å…¥å•è¯åˆ—è¡¨');
        return;
    }
    
    // è§£æå•è¯åˆ—è¡¨
    const lines = wordsText.split('\n').filter(line => line.trim());
    const words = [];
    
    for (const line of lines) {
        const trimmedLine = line.trim();
        if (!trimmedLine) continue;
        
        let word;
        if (trimmedLine.includes('|')) {
            // å®Œæ•´æ ¼å¼
            const parts = trimmedLine.split('|').map(p => p.trim());
            if (parts.length >= 2) {
                word = {
                    english: parts[0],
                    chinese: parts[1],
                    phonetic: parts[2] || '',
                    part_of_speech: parts[3] || '',
                    example: parts[4] || ''
                };
            }
        } else if (trimmedLine.includes(',')) {
            // ç®€å•æ ¼å¼
            const parts = trimmedLine.split(',').map(p => p.trim());
            if (parts.length >= 2) {
                word = {
                    english: parts[0],
                    chinese: parts[1],
                    phonetic: '',
                    part_of_speech: '',
                    example: ''
                };
            }
        }
        
        if (word && word.english && word.chinese) {
            words.push(word);
        }
    }
    
    if (words.length === 0) {
        alert('æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„å•è¯æ ¼å¼');
        return;
    }
    
    try {
        const response = await fetch('/api/words/batch', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ words: words })
        });
        
        const result = await response.json();
        
        if (result.success) {
            // å…³é—­æ¨¡æ€æ¡†
            const modal = bootstrap.Modal.getInstance(document.getElementById('batchAddModal'));
            modal.hide();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('batch-words').value = '';
            
            // é‡æ–°åŠ è½½å•è¯åˆ—è¡¨
            loadWords(1, '');
            
            alert(`æˆåŠŸæ·»åŠ  ${result.added_count} ä¸ªå•è¯ï¼`);
        } else {
            alert(result.message || 'æ‰¹é‡æ·»åŠ å¤±è´¥');
        }
    } catch (error) {
        console.error('æ‰¹é‡æ·»åŠ å¤±è´¥:', error);
        alert('æ‰¹é‡æ·»åŠ å¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// AIç”Ÿæˆå•è¯è¯¦ç»†ä¿¡æ¯
async function generateAIDetailsForAdd() {
    const english = document.getElementById('add-english').value.trim();
    
    if (!english) {
        alert('è¯·å…ˆè¾“å…¥è‹±æ–‡å•è¯');
        return;
    }
    
    const btn = document.getElementById('generate-ai-details');
    const originalText = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ç”Ÿæˆä¸­...';
    btn.disabled = true;
    
    try {
        const response = await fetch('/api/generate_word_details', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ english: english })
        });
        
        const result = await response.json();
        
        if (result.success) {
            // å¡«å……ç”Ÿæˆçš„ä¿¡æ¯
            if (result.phonetic) {
                document.getElementById('add-phonetic').value = result.phonetic;
            }
            if (result.part_of_speech) {
                document.getElementById('add-part-of-speech').value = result.part_of_speech;
            }
            if (result.example) {
                document.getElementById('add-example').value = result.example;
            }
            if (result.chinese) {
                document.getElementById('add-chinese').value = result.chinese;
            }
        } else {
            alert(result.message || 'AIç”Ÿæˆå¤±è´¥');
        }
    } catch (error) {
        console.error('AIç”Ÿæˆå¤±è´¥:', error);
        alert('AIç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
    } finally {
        btn.innerHTML = originalText;
        btn.disabled = false;
    }
}

// ä¸ºç°æœ‰å•è¯ç”ŸæˆAIè¯¦ç»†ä¿¡æ¯
async function generateAIDetails(wordId) {
    if (!confirm('ç¡®å®šè¦ä½¿ç”¨AIé‡æ–°ç”Ÿæˆè¿™ä¸ªå•è¯çš„è¯¦ç»†ä¿¡æ¯å—ï¼Ÿ')) {
        return;
    }
    
    try {
        const response = await fetch(`/api/words/${wordId}/generate-details`, {
            method: 'POST'
        });
        
        const result = await response.json();
        
        if (result.success) {
            // é‡æ–°åŠ è½½å•è¯åˆ—è¡¨
            loadWords(currentPage, currentSearch);
            alert('AIç”ŸæˆæˆåŠŸï¼');
        } else {
            alert(result.message || 'AIç”Ÿæˆå¤±è´¥');
        }
    } catch (error) {
        console.error('AIç”Ÿæˆå¤±è´¥:', error);
        alert('AIç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
    }
}

// äº‹ä»¶ç›‘å¬å™¨
document.getElementById('search-btn').addEventListener('click', searchWords);
document.getElementById('search-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        searchWords();
    }
});

document.getElementById('save-word-btn').addEventListener('click', addWord);
document.getElementById('update-word-btn').addEventListener('click', updateWord);
document.getElementById('batch-add-btn').addEventListener('click', batchAddWords);
document.getElementById('generate-ai-details').addEventListener('click', generateAIDetailsForAdd);

// é¡µé¢åŠ è½½æ—¶åŠ è½½å•è¯åˆ—è¡¨
loadWords();
</script>
{% endblock %}